# 재무데이터 처리 시스템 PRD v1

## 1. 프로젝트 개요

### 1.1 목적
- 재무 데이터의 정확성과 완결성 보장
- 원장 데이터 자동 추출 및 처리
- 엑셀 MCP 연동을 통한 데이터 처리 자동화
- 파이썬 스크립트를 통한 데이터 검증 및 보완

### 1.2 핵심 원칙
- 데이터 완결성 최우선
- 확실하지 않은 데이터는 빈 값으로 처리
- 모든 이상 데이터는 노란색(#FFFF00) 마킹
- 처리 과정의 완전한 추적성 보장

## 2. 시스템 아키텍처

### 2.1 Excel MCP 모듈
- 원장 데이터 자동 추출
- 계정별 데이터 분류 및 처리
- BS/PL 계정 구분 처리
- VAT 포함/제외 자동 계산

### 2.2 Python 처리 모듈
- 데이터 검증 및 오류 검출
- 노란색 마킹 자동화
- 로그 파일 생성 및 관리
- 교차 오염 방지 시스템

### 2.3 데이터 저장소
- 원본 엑셀 파일
- 중간 처리 결과 파일
- 로그 파일 (UTF-8 인코딩)
- 최종 처리 결과 파일

## 3. 핵심 기능 요구사항

### 3.1 Excel MCP 기능
- 원장 시트 자동 인식 및 데이터 추출
- 계정코드 자동 파싱 (정규식: \((\d+)\))
- BS/PL 계정별 차별화된 처리
- VAT 관련 계정 특별 처리

### 3.2 Python 스크립트 기능
- 데이터 검증 및 마킹
- 로그 파일 자동 생성
- 교차 오염 감지
- 결과 파일 생성

### 3.3 오류 처리 기능
- 데이터 이상 감지 및 마킹
- 상세 로그 기록
- 오류 복구 및 재시도
- 사용자 알림

## 4. 데이터 처리 규격

### 4.1 입력 데이터
- 원장 파일 형식: .xlsx
- 필수 필드: 날짜, 차변, 대변, 잔액
- 계정 정보: 시트명에 포함된 계정코드

### 4.2 출력 데이터
- 처리 결과: .xlsx
- 로그 파일: UTF-8 .log
- 검증 보고서: .xlsx
- 오류 리포트: .md

### 4.3 중간 데이터
- 월별잔액 시트
- 월별발생액 시트
- 계정분류 시트

## 5. 품질 보증 요구사항

### 5.1 데이터 검증
- 원본 데이터 무결성 검사
- 처리 결과 교차 검증
- VAT 계산 정확성 검증
- 계정 분류 정확성 검증

### 5.2 오류 처리
- 노란색 마킹 시스템
- 상세 로그 기록
- 오류 복구 메커니즘
- 사용자 통지 시스템

### 5.3 성능 요구사항
- 대용량 엑셀 파일 처리 지원
- 실시간 오류 감지
- 빠른 데이터 처리 속도
- 안정적인 메모리 사용

## 6. 보안 요구사항

### 6.1 데이터 보안
- 원본 데이터 보호
- 처리 결과 백업
- 로그 파일 보안
- 접근 권한 관리

### 6.2 시스템 보안
- 에러 메시지 보안
- 임시 파일 관리
- 백업 파일 보호
- 로그 파일 암호화

## 7. 유지보수 요구사항

### 7.1 코드 관리
- 버전 관리
- 문서화
- 테스트 자동화
- 디버깅 도구

### 7.2 모니터링
- 처리 상태 모니터링
- 오류 발생 추적
- 성능 모니터링
- 리소스 사용 모니터링