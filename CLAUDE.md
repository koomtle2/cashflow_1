# 재무 프로젝트 공통 매뉴얼

## 최우선 원칙: 데이터 완결성

### 절대 원칙
- **데이터 완결성이 모든 다른 고려사항보다 우선**
- 확실하지 않은 데이터는 절대 입력하지 않음
- 추정값, 기본값(0), 근사치 입력 완전 금지
- **의심스러우면 빈 값으로 두고 시각적 표시**

### 데이터 이상 시 처리 방법
- 해당 Excel 셀을 노란색(#FFFF00)으로 마킹
- 값은 비워두거나 원본 그대로 유지
- ./log/YYYY-MM-DD_HHMMSS.log 파일에 상세 기록
- 사용자에게 명확한 이슈 보고

### 핵심 철학
**틀린 데이터보다 빈 데이터가 훨씬 안전하다**

## 세션 시작 체크리스트 (필수)

### 매 세션 시작시 반드시 확인
1. **PROJECT_STATUS.md 섹션 1 읽기**: 현재 세션 요약
2. **진행중인 작업 확인**: todo 상태 점검
3. **최근 로그 파일 확인**: ./log/최신파일.log
4. **기존 Script 폴더만 사용** 명시적 확인

### 작업 연속성 보장
- 이전 세션 주요 발견사항 파악
- 미완료 작업 우선순위 결정
- 새 작업 시작 전 기존 결과 검증

## 작업 원칙

### 1. 파일 관리
- 작업 완료시 **반드시 파일 전체 경로** 명시
- 기존 파일 편집 우선, 새 파일 생성 최소화
- Excel 파일에는 **색상 적용 금지** (노란색 마킹 예외)

### 2. 응답 형식 (필수)
```
작업 파일: [전체 경로]

[응답 내용]

작업 완료 파일: [전체 경로]
```

### 3. 재무 데이터 처리 핵심
- **VAT 포함/제외 여부 반드시 확인**
- 부가세대급금(13500) 계정과 연계 분석
- 재무제표용 데이터는 VAT 제외 금액 사용

### 4. 보고 검증 의무화
**모든 작업 보고 전 반드시:**
- [ ] 실제 데이터 출력 확인됨
- [ ] 로그 파일에 기록됨
- [ ] 오류 메시지 없음
- [ ] 추정/가정 없이 작성됨
- [ ] 로그와 보고서 내용 100% 일치

## Python 스크립트 활용 규칙

### 🚨 절대 금지 사항
- **PRD에 맞지 않는 새로운 스크립트 생성 절대 금지**
- **임시 분석용 .py 파일 생성 금지**
- **사용자 명시적 승인 없는 새 파일 생성 완전 차단**

### 허용되는 작업
- **c:\K04_cashflow_1\Script 폴더의 기존 코드만** 활용
- 기존 스크립트 수정/확장 (사용자 승인 하에)
- 유사한 작업의 기존 스크립트 재사용

### 스크립트 실행 전 확인
- 파일 경로와 시트명 스크립트와 일치 확인
- 백업 파일 생성 여부 확인
- 실행 전 샘플 데이터로 테스트

## UTF-8 인코딩 필수

### 모든 텍스트 파일
- **.txt, .md 파일은 반드시 UTF-8 인코딩**
- Python 파일 처리시 `encoding='utf-8'` 명시
- 로그 파일 생성시 UTF-8 인코딩 보장

### Python 코드 표준
```python
# 텍스트 파일 읽기/쓰기
open(파일, 'r/w', encoding='utf-8')

# 로그 설정
logging.basicConfig(encoding='utf-8')

# pandas Excel 저장
df.to_excel(파일, encoding='utf-8-sig')
```

## Excel 작업 규칙

### 함수 호환성 우선
- **안정성 > 기능**: 모든 환경에서 작동하는 함수 사용
- **IFS 등 신규 함수**: 호환성 검증 후 사용
- **중첩 IF 우선**: 불확실한 환경에서는 기존 함수 사용

### 데이터 입력 원칙
- 데이터만 입력, 서식/색상 적용 금지
- 수식 적용 전 반드시 샘플 검증
- 계산식보다는 확정된 수치 우선

## PROJECT_STATUS.md 활용법

### 정보 분류
- **섹션 1**: 현재 세션 요약 (매번 확인)
- **섹션 3**: 기술 가이드 (필요시 참조)
- **섹션 4**: 교훈 보관소 (문제 해결시 참조)
- **섹션 5**: 도구 매뉴얼 (구현시 참조)

### Context 효율성
- 전체 로드 대신 필요한 섹션만 읽기
- 상세 기술 내용은 PROJECT_STATUS.md에서 확인
- 반복 작업은 패턴 재사용

## 재무 용어 정의

### 계정 과목
- **미지급금(25300)**: 재화/용역 제공받았으나 미지급 채무
- **부가세대급금(13500)**: 지급할 부가가치세
- **부가세예수금(25500)**: 수취한 부가가치세

### 분석 용어
- **VAT 포함**: 부가세가 포함된 총액
- **VAT 제외**: 부가세를 제외한 순액 (실제 비용)
- **지급률**: 지급완료 금액 / 총 채무 금액

## 주의사항

### 데이터 검증
- 원장 잔액과 세부 내역 일치성 확인
- VAT 계산시 10% 세율 적용
- 비과세 거래 (법무, 번역 등) 구분

### 보고서 작성
- 결론을 먼저 제시
- 구체적 금액과 비율 명시
- 파일 경로 반드시 포함

### 오류 처리
- 모든 에러 메시지 상세 분석 후 보고
- 동일 방식 3회 실패시 다른 접근법 시도
- 결과 검증은 반드시 실제 데이터로 확인

---
*이 매뉴얼은 모든 재무 프로젝트에 공통 적용됩니다.*
*상세 기술 가이드는 PROJECT_STATUS.md를 참조하세요.*